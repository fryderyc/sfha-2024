# -*- coding: utf-8 -*-
"""Malware Analysis

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1lfjya0Rci2IO4CT5kshzvt2axYOGp1XS
"""

!pip install yara-python
import yara

malware_rules = yara.compile("malware_rules.yar")

sample_data = "Do not use community python or python 2"

result_for_malware = malware_rules.match(data=sample_data)
print(result_for_malware)

# Commented out IPython magic to ensure Python compatibility.
# %%writefile virus_rule.yar
# rule virus_rule {
#   strings:
#     $virus_string = "virus"
#   condition:
#     $virus_string
# }

# Commented out IPython magic to ensure Python compatibility.
# %%writefile malware_rule.yar
# rule malware_rule {
#   strings:
#     $malware_string = "malware"
#   condition:
#     $malware_string
# }